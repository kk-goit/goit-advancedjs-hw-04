{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst defParams = {\n    key: \"46481963-10f537a41063d6fd7fead7408\",\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: \"true\",\n    per_page: 15,\n    page: 1,\n};\nvar curParams = {\n    q: '',\n};\n\nasync function doQuery() { \n    const resp = await axios.get(\"\", { params: curParams });\n\n    resp.data.totalPages = Math.floor(resp.data.totalHits / defParams.per_page) + 1;\n    return resp.data;\n}\n\nfunction searchPhotos(queryStr) { \n    curParams = defParams;\n    curParams.q = queryStr;\n\n    return doQuery();\n}\n\nfunction nextPage() {\n    curParams.page += 1;\n\n    return doQuery();\n }\n\nexport { searchPhotos, nextPage }","\nfunction createGallery(photos) { \n  const galHtml = document.createElement('ul');\n  for (const imgData of photos) { \n    const li = document.createElement('li');\n    li.classList.add(\"gallery-item\");\n  \n    const img = document.createElement('img');\n    img.classList.add(\"gallery-image\");\n    img.setAttribute('src', imgData.webformatURL);\n    img.setAttribute('alt', imgData.tags);\n  \n    const a = document.createElement('a');\n    a.classList.add('gallery-link')\n    a.setAttribute('href', imgData.largeImageURL);\n    a.append(img);\n\n    li.append(a);\n\n    const desc = document.createElement('div');\n    desc.classList.add(\"gallery-descr\");\n\n    const likes = document.createElement('div');\n    likes.innerHTML = `<span>Likes</span>${imgData.likes}`;\n    desc.append(likes);\n    const views = document.createElement('div');\n    views.innerHTML = `<span>Views</span>${imgData.views}`;\n    desc.append(views);\n    const comms = document.createElement('div');\n    comms.innerHTML = `<span>Comments</span>${imgData.comments}`;\n    desc.append(comms);\n    const dwnlds = document.createElement('div');\n    dwnlds.innerHTML = `<span>Downloads</span>${imgData.downloads}`;\n    desc.append(dwnlds);\n\n    li.append(desc);\n\n    galHtml.append(li);\n  }\n  return galHtml.innerHTML;\n}\n\nfunction renderPaginator(params) { \n  const { loadButton, nothingMore, curPage, totalPages } = params;\n  if (curPage < totalPages) { \n    // have more data\n    loadButton.classList.remove(\"visually-hidden\");\n    nothingMore.classList.add(\"visually-hidden\");\n    return true;\n  } else {\n    // last page\n    loadButton.classList.add(\"visually-hidden\");\n    nothingMore.classList.remove(\"visually-hidden\");\n    return false;\n  }\n}\n\nexport { createGallery, renderPaginator }\n\n","// import needed libs\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n// import own main styles\nimport \"./css/styles.css\";\n\nimport { searchPhotos, nextPage } from \"./js/pixabay-api.js\";\nimport { createGallery, renderPaginator } from \"./js/render-functions.js\";\n\nconst sLightBox = new SimpleLightbox(\n    '.gallery a',\n    {\n      overlayOpacity: 0.8,\n      className: 'gallery-wrapper',\n      captionsData: 'alt',\n      captionDelay: 250\n    }\n);\niziToast.settings({\n    class: \"toast\",\n    position: \"topRight\",\n    drag: false,\n});\n\nconst theLoader = document.querySelector('.load_more span');\nconst theGallery = document.querySelector('.gallery');\n\nvar curPage = 1;\nvar totalPages = 1;\nconst loadMore = document.querySelector(\".load_more button\");\nconst nothingMore = document.querySelector(\".load_more span\");\nconst nothingMoreMsg = \"We're sorry, but you've reached the end of search results.\";\n\ndocument.getElementById(\"search-form\").addEventListener(\"submit\", e => {\n    e.preventDefault();\n    const form = e.currentTarget;\n    const queryStr = form.elements.queryStr.value.trim();\n\n    if (queryStr === \"\") {\n        form.reset();\n        return; // do nothing for empty query string\n    }\n\n    theLoader.classList.remove('visually-hidden');\n    theGallery.classList.add('visually-hidden');   \n    theGallery.innerHTML = '';\n    loadMore.classList.add('visually-hidden'); \n    searchPhotos(queryStr)\n        .then(data => {\n            if (data.total == 0 || data.hits.length == 0) {\n                iziToast.error({ message: \"Sorry, there are no images matching your search query. Please try again!\" });\n            } else { \n                curPage = 1;\n                totalPages = data.totalPages;\n\n                theGallery.innerHTML = createGallery(data.hits);\n                theGallery.classList.remove(\"visually-hidden\");\n                sLightBox.refresh();\n\n                if (!renderPaginator({loadButton: loadMore, nothingMore: nothingMore, curPage: curPage, totalPages: totalPages}))\n                    iziToast.info({message: nothingMoreMsg});\n            }\n        })\n        .catch(err => {\n            iziToast.error({message: err.message});\n         })\n        .finally(() => {\n            theLoader.classList.add('visually-hidden');\n            form.reset()\n        });\n});\n\nloadMore.addEventListener(\"click\", e => { \n    e.preventDefault();\n\n    theLoader.classList.remove('visually-hidden');\n    loadMore.classList.add('visually-hidden'); \n    nextPage()\n        .then(data => {\n            curPage += 1;\n            totalPages = data.totalPages;\n\n            theGallery.innerHTML += createGallery(data.hits);\n            sLightBox.refresh();\n\n            const liRect = theGallery.querySelector(\"li:last-child\").getBoundingClientRect();\n            window.scrollBy(0, liRect.height*2);\n\n            if (!renderPaginator({loadButton: loadMore, nothingMore: nothingMore, curPage: curPage, totalPages: totalPages}))\n                iziToast.info({message: nothingMoreMsg});\n        })\n        .catch(err => { \n            iziToast.error({message: err.message});\n        })\n        .finally(() => {\n            theLoader.classList.add('visually-hidden');\n        });\n});"],"names":["axios","defParams","curParams","doQuery","resp","searchPhotos","queryStr","nextPage","createGallery","photos","galHtml","imgData","li","img","a","desc","likes","views","comms","dwnlds","renderPaginator","params","loadButton","nothingMore","curPage","totalPages","sLightBox","SimpleLightbox","iziToast","theLoader","theGallery","loadMore","nothingMoreMsg","e","form","data","err","liRect"],"mappings":"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"}