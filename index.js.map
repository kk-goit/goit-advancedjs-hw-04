{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst theParams = {\n    key: \"46481963-10f537a41063d6fd7fead7408\",\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: \"true\",\n    per_page: 15,\n};\n\nasync function doQuery() { \n    const resp = await axios.get(\"\", { params: theParams });\n\n    resp.data.totalPages = Math.floor(resp.data.totalHits / theParams.per_page) + 1;\n    return resp.data;\n}\n\nfunction searchPhotos(queryStr) { \n    theParams.page = 1;\n    theParams.q = queryStr;\n\n    return doQuery();\n}\n\nfunction nextPage() {\n    theParams.page += 1;\n\n    return doQuery();\n }\n\nexport { searchPhotos, nextPage }","\nfunction createGallery(photos) { \n  var galHtml = '';\n  for (const imgData of photos) { \n    galHtml += `<li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${imgData.largeImageURL}\">\n        <img class=\"gallery-image\" src=\"${imgData.webformatURL}\" alt=\"${imgData.tags}\">\n      </a>\n      <div class=\"gallery-descr\">\n        <div><span>Likes</span>${imgData.likes}</div>\n        <div><span>Views</span>${imgData.views}</div>\n        <div><span>Comments</span>${imgData.comments}</div>\n        <div><span>Downloads</span>${imgData.downloads}</div>\n      </div>\n    </li>`;\n  }\n  return galHtml;\n}\n\nfunction renderPaginator(params) { \n  const { loadButton, curPage, totalPages, iziToast, msg } = params;\n  if (curPage < totalPages) { \n    // have more data\n    loadButton.classList.remove(\"visually-hidden\");\n  } else {\n    // last page\n    loadButton.classList.add(\"visually-hidden\");\n    iziToast.info({message: msg})\n  }\n}\n\nexport { createGallery, renderPaginator }\n\n","// import needed libs\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n// import own main styles\nimport \"./css/styles.css\";\n\nimport { searchPhotos, nextPage } from \"./js/pixabay-api.js\";\nimport { createGallery, renderPaginator } from \"./js/render-functions.js\";\n\nconst sLightBox = new SimpleLightbox(\n    '.gallery a',\n    {\n      overlayOpacity: 0.8,\n      className: 'gallery-wrapper',\n      captionsData: 'alt',\n      captionDelay: 250\n    }\n);\niziToast.settings({\n    class: \"toast\",\n    position: \"topRight\",\n    drag: false,\n});\n\nconst theLoader = document.querySelector('.load_more span');\nconst theGallery = document.querySelector('.gallery');\n\nvar curPage = 1;\n\nconst loadMore = document.querySelector(\".load_more button\");\nconst nothingMoreMsg = \"We're sorry, but you've reached the end of search results.\";\n\ndocument.getElementById(\"search-form\").addEventListener(\"submit\", e => {\n    e.preventDefault();\n    const form = e.currentTarget;\n    const queryStr = form.elements.queryStr.value.trim();\n\n    if (queryStr === \"\") {\n        form.reset();\n        return; // do nothing for empty query string\n    }\n\n    theLoader.classList.remove('visually-hidden');\n    theGallery.classList.add('visually-hidden');   \n    theGallery.innerHTML = '';\n    loadMore.classList.add('visually-hidden'); \n    searchPhotos(queryStr)\n        .then(data => {\n            if (data.total == 0 || data.hits.length == 0) {\n                iziToast.error({ message: \"Sorry, there are no images matching your search query. Please try again!\" });\n            } else { \n                curPage = 1;\n\n                theGallery.innerHTML = createGallery(data.hits);\n                theGallery.classList.remove(\"visually-hidden\");\n                sLightBox.refresh();\n\n                renderPaginator({\n                    loadButton: loadMore,\n                    curPage: curPage, totalPages: data.totalPages,\n                    iziToast: iziToast, msg: nothingMoreMsg\n                });\n            }\n        })\n        .catch(err => {\n            iziToast.error({message: err.message});\n         })\n        .finally(() => {\n            theLoader.classList.add('visually-hidden');\n            form.reset()\n        });\n});\n\nloadMore.addEventListener(\"click\", e => { \n    e.preventDefault();\n\n    theLoader.classList.remove('visually-hidden');\n    loadMore.classList.add('visually-hidden'); \n    nextPage()\n        .then(data => {\n            curPage += 1;\n\n            theGallery.insertAdjacentHTML(\"beforeend\", createGallery(data.hits));\n            sLightBox.refresh();\n\n            const liRect = theGallery.querySelector(\"li:last-child\").getBoundingClientRect();\n            window.scrollBy(0, liRect.height*2);\n\n            renderPaginator({\n                loadButton: loadMore,\n                curPage: curPage, totalPages: data.totalPages,\n                iziToast: iziToast, msg: nothingMoreMsg\n            });\n        })\n        .catch(err => { \n            iziToast.error({message: err.message});\n        })\n        .finally(() => {\n            theLoader.classList.add('visually-hidden');\n        });\n});"],"names":["axios","theParams","doQuery","resp","searchPhotos","queryStr","nextPage","createGallery","photos","galHtml","imgData","renderPaginator","params","loadButton","curPage","totalPages","iziToast","msg","sLightBox","SimpleLightbox","theLoader","theGallery","loadMore","nothingMoreMsg","e","form","data","err","liRect"],"mappings":"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"}